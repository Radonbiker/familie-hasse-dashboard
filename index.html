<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>Familie Hasse ‚Äì Essensplan</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <meta name="theme-color" content="#1a100b" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <link rel="manifest" href="manifest.json" />
  <link rel="apple-touch-icon" href="apple-touch-icon.png" />
  <style>
    :root {
      --bg-top: #25160f;
      --bg-bottom: #120a06;
      --card: #1c110b;
      --accent: #e0a15b;
      --accent-soft: #f3c48a;
      --border-soft: rgba(255,255,255,0.12);
      --text: #f6e7d5;
      --text-soft: #c8a88a;
      --radius: 18px;
    }

    * {
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text", "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #3a2316 0, var(--bg-top) 40%, var(--bg-bottom) 100%);
      color: var(--text);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    .app {
      max-width: 1320px;
      margin: 0 auto;
      padding: 10px 12px 14px;
      flex: 1;
      display: grid;
      grid-template-columns: 1.1fr 1.2fr;
      grid-template-rows: auto 1fr;
      gap: 10px;
    }

    @media (max-width: 980px) {
      .app {
        grid-template-columns: 1fr;
        grid-template-rows: auto auto auto auto;
      }
    }

    .card {
      background: radial-gradient(circle at top, #352016 0, #160c07 58%, #0b0604 100%);
      border-radius: var(--radius);
      border: 1px solid var(--border-soft);
      box-shadow: 0 10px 24px rgba(0,0,0,0.6);
      padding: 10px;
      min-height: 80px;
    }

    .card h2 {
      margin: 0 0 4px;
      font-size: 1rem;
      color: var(--accent-soft);
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .card small {
      font-size: 0.78rem;
      color: var(--text-soft);
    }

    /* Layout-Zuordnung */
    #card-favorites { grid-column: 1; grid-row: 1; }
    #card-week-current { grid-column: 2; grid-row: 1; }
    #card-meals { grid-column: 1; grid-row: 2; }
    #card-week-next { grid-column: 2; grid-row: 2; }

    @media (max-width: 980px) {
      #card-favorites { grid-column: 1; grid-row: 1; }
      #card-week-current { grid-column: 1; grid-row: 2; }
      #card-week-next { grid-column: 1; grid-row: 3; }
      #card-meals { grid-column: 1; grid-row: 4; }
    }

    /* Lieblingsgerichte */
    .fav-grid {
      margin-top: 6px;
      display: grid;
      grid-template-columns: repeat(4, minmax(0, 1fr));
      gap: 6px;
    }
    @media (min-width: 900px) {
      .fav-grid { grid-template-columns: repeat(5, minmax(0, 1fr)); }
    }
    @media (min-width: 1200px) {
      .fav-grid { grid-template-columns: repeat(6, minmax(0, 1fr)); }
    }

    .fav-bubble {
      background: rgba(0,0,0,0.45);
      border-radius: 999px;
      padding: 5px 6px;
      text-align: center;
      font-size: 0.78rem;
      cursor: pointer;
      border: 1px solid rgba(255,255,255,0.16);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 1px;
      min-height: 46px;
      user-select: none;
    }

    .fav-bubble .emoji {
      font-size: 1.1rem;
    }

    .fav-bubble.active {
      background: var(--accent);
      color: #2a150b;
      border-color: var(--accent-soft);
    }

    /* Wochenpl√§ne */
    .week-header {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      margin-bottom: 4px;
      font-size: 0.8rem;
      color: var(--text-soft);
    }

    .week-grid {
      display: grid;
      grid-template-columns: repeat(7, minmax(0, 1fr));
      gap: 6px;
      font-size: 0.78rem;
    }

    @media (max-width: 1200px) {
      .week-grid {
        grid-template-columns: repeat(4, minmax(0, 1fr));
      }
    }

    .day-col {
      background: rgba(0,0,0,0.35);
      border-radius: 12px;
      padding: 4px;
    }

    .day-title {
      text-align: center;
      font-weight: 600;
      margin-bottom: 2px;
      cursor: pointer;
    }

    .day-title span {
      border-radius: 999px;
      padding: 2px 6px;
    }

    .day-title span:hover {
      background: rgba(255,255,255,0.08);
    }

    .slot {
      background: rgba(0,0,0,0.4);
      border-radius: 9px;
      border: 1px dashed rgba(255,255,255,0.18);
      padding: 4px;
      margin-top: 3px;
      min-height: 48px;
      cursor: pointer;
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .slot-label {
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.06em;
      color: var(--text-soft);
    }

    .slot-content {
      font-size: 0.84rem;
      font-weight: 600;
      min-height: 1.1em;
    }

    .slot.empty .slot-content {
      font-size: 0.76rem;
      color: #9c7a54;
    }

    .slot.drag-over {
      background: rgba(250,210,140,0.18);
      border-color: var(--accent-soft);
    }

    .week-buttons {
      margin-top: 6px;
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      font-size: 0.78rem;
    }

    .btn {
      border-radius: 999px;
      border: none;
      padding: 5px 10px;
      font-size: 0.78rem;
      background: rgba(0,0,0,0.55);
      color: var(--text-soft);
      cursor: pointer;
    }

    .btn.primary {
      background: var(--accent);
      color: #2a150b;
      font-weight: 600;
    }

    /* Alle Gerichte */
    .meal-search-row {
      display: flex;
      gap: 6px;
      margin: 4px 0 6px;
      align-items: center;
    }

    .meal-search-row input {
      flex: 1;
      padding: 6px 8px;
      border-radius: 999px;
      border: none;
      background: rgba(0,0,0,0.6);
      color: var(--text);
      font-size: 0.83rem;
    }

    .meal-list {
      max-height: 190px;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      gap: 5px;
      padding-right: 4px;
      margin-bottom: 4px;
    }

    .meal-card {
      background: rgba(0,0,0,0.45);
      border-radius: 11px;
      padding: 4px 7px;
      display: flex;
      align-items: center;
      gap: 6px;
      cursor: pointer;
      border: 1px solid rgba(255,255,255,0.1);
      font-size: 0.84rem;
      user-select: none;
    }

    .meal-card .emoji {
      font-size: 1.1rem;
    }

    .meal-card .name {
      flex: 1;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .meal-card .edit,
    .meal-card .delete {
      font-size: 1rem;
      opacity: 0.85;
      cursor: pointer;
    }

    .meal-card .edit:hover,
    .meal-card .delete:hover {
      opacity: 1;
    }

    .meal-card.selected {
      background: var(--accent);
      color: #2a150b;
      border-color: var(--accent-soft);
    }

    .meal-form {
      margin-top: 4px;
      display: flex;
      flex-wrap: wrap;
      gap: 4px;
      align-items: center;
      font-size: 0.82rem;
    }

    .meal-form input {
      border-radius: 9px;
      border: none;
      background: rgba(0,0,0,0.6);
      color: var(--text);
      padding: 6px 7px;
      font-size: 0.82rem;
      min-width: 0;
    }

    .meal-form input[name="name"] {
      flex: 1.3;
    }

    .meal-form input[name="emoji"] {
      width: 80px;
      text-align: center;
    }

    .meal-form button {
      border-radius: 9px;
      border: none;
      background: var(--accent);
      color: #2a150b;
      padding: 7px 10px;
      font-weight: 600;
      cursor: pointer;
    }

    footer {
      font-size: 0.72rem;
      color: var(--text-soft);
      text-align: center;
      padding: 4px 0 6px;
      opacity: 0.9;
    }
  </style>
</head>
<body>
  <div class="app">
    <!-- Links oben: Lieblingsgerichte -->
    <section class="card" id="card-favorites">
      <h2>Lieblingsgerichte</h2>
      <small>Antippen, dann unten einen Slot ber√ºhren. Gelb = aktuell ausgew√§hlt.</small>
      <div id="fav-grid" class="fav-grid"></div>
    </section>

    <!-- Rechts oben: aktuelle Woche -->
    <section class="card" id="card-week-current">
      <div class="week-header">
        <span>Aktuelle Woche (Tag antippen = Zutatenliste f√ºr den Tag)</span>
        <span id="week-current-range"></span>
      </div>
      <div id="week-current" class="week-grid"></div>
      <div class="week-buttons">
        <button class="btn primary" id="btn-week-today">Heutiger Tag ‚Äì Zutaten anzeigen</button>
        <button class="btn" id="btn-clear-week">Aktuelle Woche leeren</button>
      </div>
    </section>

    <!-- Links unten: alle Gerichte -->
    <section class="card" id="card-meals">
      <h2>Alle Gerichte</h2>
      <small>Tap = Gericht ausw√§hlen ¬∑ üìù Zutaten bearbeiten ¬∑ üóëÔ∏è l√∂schen.</small>

      <div class="meal-search-row">
        <input id="meal-search" placeholder="In Gerichten suchen ‚Ä¶" />
      </div>

      <div id="meal-list" class="meal-list"></div>

      <form id="meal-form" class="meal-form">
        <input name="name" id="meal-name" placeholder="Neues Gericht (z. B. Lasagne)" required />
        <input name="emoji" id="meal-emoji" placeholder="Emoji üçù" />
        <button type="submit">‚ûï Hinzuf√ºgen</button>
      </form>
    </section>

    <!-- Rechts unten: n√§chste Woche -->
    <section class="card" id="card-week-next">
      <div class="week-header">
        <span>N√§chste Woche (Planung f√ºr kommende Tage)</span>
        <span id="week-next-range"></span>
      </div>
      <div id="week-next" class="week-grid"></div>
      <div class="week-buttons">
        <button class="btn primary" id="btn-shopping-all">Einkaufsliste f√ºr alle geplanten Tage</button>
        <button class="btn" id="btn-clear-all">Beide Wochen leeren</button>
      </div>
    </section>
  </div>

  <footer>
    Alles l√§uft lokal im Browser auf diesem iPad. Gerichte, Zutaten & Wochenplan geh√∂ren nur euch. ‚ù§Ô∏è
  </footer>

  <script>
    const STORAGE_KEY = "familie_hasse_essenplan_v5";

    const defaultMeals = [
      {id:"spagbol", name:"Spaghetti Bolognese", emoji:"üçù"},
      {id:"gulasch", name:"Gulasch", emoji:"üç≤"},
      {id:"rouladen", name:"Rouladen mit Kl√∂√üen", emoji:"ü•©"},
      {id:"pizza", name:"Pizza", emoji:"üçï"},
      {id:"klopse", name:"K√∂nigsberger Klopse", emoji:"üçñ"},
      {id:"schnipom", name:"Schnitzel mit Pommes", emoji:"üçü"},
      {id:"bowl", name:"Bowl", emoji:"ü•ó"},
      {id:"geschnetzeltes", name:"Geschnetzeltes", emoji:"üçõ"},
    ];

    const defaultFavorites = ["spagbol","gulasch","rouladen","pizza","klopse","schnipom","bowl","geschnetzeltes"];
    const dayNames = ["Mo","Di","Mi","Do","Fr","Sa","So"];

    function createEmptyWeek() {
      const w = [];
      for (let i = 0; i < 7; i++) {
        w.push({lunch:null, dinner:null});
      }
      return w;
    }

    function getMonday(date = new Date()) {
      const d = new Date(date);
      const day = d.getDay(); // 0=So
      const diff = (day === 0 ? -6 : 1 - day);
      d.setDate(d.getDate() + diff);
      d.setHours(0,0,0,0);
      return d;
    }

    function formatRange(monday) {
      const start = new Date(monday);
      const end = new Date(monday);
      end.setDate(end.getDate()+6);
      const fmt = d => d.toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit"});
      return fmt(start) + " ‚Äì " + fmt(end);
    }

    function baseState() {
      const currentMonday = getMonday();
      return {
        meals: [...defaultMeals],
        favorites: [...defaultFavorites],
        ingredients: {}, // { mealId: ["Zutat 1", "Zutat 2"] }
        weekCurrent: createEmptyWeek(),
        weekNext: createEmptyWeek(),
        currentMondayISO: currentMonday.toISOString()
      };
    }

    function loadState() {
      try {
        const raw = localStorage.getItem(STORAGE_KEY);
        if (!raw) return baseState();
        const st = JSON.parse(raw);

        if (!st.meals) st.meals = [...defaultMeals];
        if (!st.favorites) st.favorites = [...defaultFavorites];
        if (!st.ingredients) st.ingredients = {};
        if (!st.weekCurrent) st.weekCurrent = createEmptyWeek();
        if (!st.weekNext) st.weekNext = createEmptyWeek();
        if (!st.currentMondayISO) st.currentMondayISO = getMonday().toISOString();

        // Wochenrotation: wenn eine ganze Woche vergangen ist
        const storedMonday = new Date(st.currentMondayISO);
        const nowMonday = getMonday();
        const diffDays = Math.floor((nowMonday - storedMonday) / (1000*60*60*24));
        if (diffDays >= 7) {
          st.weekCurrent = st.weekNext;
          st.weekNext = createEmptyWeek();
          st.currentMondayISO = nowMonday.toISOString();
        }

        return st;
      } catch (e) {
        console.error("Fehler beim Laden:", e);
        return baseState();
      }
    }

    function saveState() {
      try {
        localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
      } catch (e) {
        console.error("Fehler beim Speichern:", e);
      }
    }

    let state = loadState();
    let activeTapMealId = null;

    const favGridEl = document.getElementById("fav-grid");
    const mealListEl = document.getElementById("meal-list");
    const mealSearchEl = document.getElementById("meal-search");
    const weekCurrentEl = document.getElementById("week-current");
    const weekNextEl = document.getElementById("week-next");
    const weekCurrentRangeEl = document.getElementById("week-current-range");
    const weekNextRangeEl = document.getElementById("week-next-range");

    function getMealById(id) {
      return state.meals.find(m => m.id === id) || null;
    }

    function getIngredientsForMeal(id) {
      const arr = state.ingredients[id];
      if (!arr || !arr.length) return ["(keine Zutaten hinterlegt)"];
      return arr;
    }

    function setActiveMeal(id) {
      activeTapMealId = (activeTapMealId === id ? null : id);
      renderFavorites();
      renderMealList();
    }

    function renderFavorites() {
      favGridEl.innerHTML = "";
      state.favorites.forEach(id => {
        const meal = getMealById(id);
        if (!meal) return;
        const div = document.createElement("div");
        div.className = "fav-bubble" + (activeTapMealId === meal.id ? " active" : "");
        div.innerHTML = `<div class="emoji">${meal.emoji || "üçΩÔ∏è"}</div><div>${meal.name}</div>`;
        div.addEventListener("click", () => setActiveMeal(meal.id));
        favGridEl.appendChild(div);
      });
    }

    function renderMealList() {
      mealListEl.innerHTML = "";
      const term = mealSearchEl.value.trim().toLowerCase();
      state.meals.forEach(meal => {
        if (term && !meal.name.toLowerCase().includes(term)) return;
        const card = document.createElement("div");
        card.className = "meal-card" + (activeTapMealId === meal.id ? " selected" : "");
        card.innerHTML = `
          <span class="emoji">${meal.emoji || "üçΩÔ∏è"}</span>
          <span class="name">${meal.name}</span>
          <span class="edit">üìù</span>
          <span class="delete">üóëÔ∏è</span>
        `;

        card.addEventListener("click", (e) => {
          const target = e.target;
          if (target.classList.contains("edit") || target.classList.contains("delete")) return;
          setActiveMeal(meal.id);
        });

        card.querySelector(".edit").addEventListener("click", (e) => {
          e.stopPropagation();
          const current = (state.ingredients[meal.id] || []).join(", ");
          const updated = prompt(
            `Zutaten f√ºr "${meal.name}" (mit Komma trennen):`,
            current
          );
          if (updated === null) return;
          const parts = updated
            .split(",")
            .map(s => s.trim())
            .filter(s => s.length > 0);
          state.ingredients[meal.id] = parts;
          saveState();
          alert(`Zutaten f√ºr "${meal.name}" gespeichert.`);
        });

        card.querySelector(".delete").addEventListener("click", (e) => {
          e.stopPropagation();
          if (!confirm(`"${meal.name}" wirklich l√∂schen?`)) return;
          state.meals = state.meals.filter(m => m.id !== meal.id);
          state.favorites = state.favorites.filter(fid => fid !== meal.id);
          delete state.ingredients[meal.id];
          state.weekCurrent.forEach(d => {
            if (d.lunch === meal.id) d.lunch = null;
            if (d.dinner === meal.id) d.dinner = null;
          });
          state.weekNext.forEach(d => {
            if (d.lunch === meal.id) d.lunch = null;
            if (d.dinner === meal.id) d.dinner = null;
          });
          if (activeTapMealId === meal.id) activeTapMealId = null;
          saveState();
          renderAll();
        });

        mealListEl.appendChild(card);
      });
    }

    function renderWeeks() {
      const currentMonday = new Date(state.currentMondayISO);
      const nextMonday = new Date(currentMonday);
      nextMonday.setDate(nextMonday.getDate() + 7);

      weekCurrentRangeEl.textContent = formatRange(currentMonday);
      weekNextRangeEl.textContent = formatRange(nextMonday);

      renderWeekGrid(state.weekCurrent, weekCurrentEl, 0);
      renderWeekGrid(state.weekNext, weekNextEl, 1);
    }

    function renderWeekGrid(weekData, container, weekIndex) {
      container.innerHTML = "";
      weekData.forEach((day, dayIndex) => {
        const col = document.createElement("div");
        col.className = "day-col";

        const title = document.createElement("div");
        title.className = "day-title";
        const span = document.createElement("span");
        span.textContent = dayNames[dayIndex];
        span.addEventListener("click", () => {
          showIngredientsForDay(weekIndex, dayIndex);
        });
        title.appendChild(span);
        col.appendChild(title);

        ["lunch", "dinner"].forEach(slotKey => {
          const slotEl = document.createElement("div");
          slotEl.className = "slot";
          slotEl.dataset.week = weekIndex;
          slotEl.dataset.day = dayIndex;
          slotEl.dataset.slot = slotKey;

          const label = document.createElement("div");
          label.className = "slot-label";
          label.textContent = slotKey === "lunch" ? "Mittag" : "Abend";

          const content = document.createElement("div");
          content.className = "slot-content";

          const mealId = weekData[dayIndex][slotKey];
          if (mealId) {
            const meal = getMealById(mealId);
            content.textContent = meal ? `${meal.emoji || "üçΩÔ∏è"} ${meal.name}` : "(Gericht fehlt)";
          } else {
            slotEl.classList.add("empty");
            content.textContent = "Slot antippen zum F√ºllen/L√∂schen";
          }

          slotEl.appendChild(label);
          slotEl.appendChild(content);

          slotEl.addEventListener("click", () => {
            const w = parseInt(slotEl.dataset.week, 10);
            const d = parseInt(slotEl.dataset.day, 10);
            const key = slotEl.dataset.slot;
            const targetWeek = (w === 0) ? state.weekCurrent : state.weekNext;

            if (activeTapMealId) {
              const meal = getMealById(activeTapMealId);
              if (!meal) return;
              targetWeek[d][key] = meal.id;
              saveState();
              renderWeeks();
            } else if (targetWeek[d][key]) {
              if (confirm("Eintrag l√∂schen?")) {
                targetWeek[d][key] = null;
                saveState();
                renderWeeks();
              }
            }
          });

          col.appendChild(slotEl);
        });

        container.appendChild(col);
      });
    }

    function showIngredientsForDay(weekIndex, dayIndex) {
      const weekLabel = weekIndex === 0 ? "Aktuelle Woche" : "N√§chste Woche";
      const dayLabel = dayNames[dayIndex];
      const weekData = (weekIndex === 0) ? state.weekCurrent : state.weekNext;
      const day = weekData[dayIndex];

      let text = `${weekLabel} ‚Äì ${dayLabel}\n\n`;

      ["lunch","dinner"].forEach(slotKey => {
        const mealId = day[slotKey];
        const slotLabel = slotKey === "lunch" ? "Mittag" : "Abend";
        if (!mealId) {
          text += `${slotLabel}:\n  (kein Gericht eingetragen)\n\n`;
        } else {
          const meal = getMealById(mealId);
          const name = meal ? meal.name : "(Gericht fehlt)";
          text += `${slotLabel} ‚Äì ${name}\n`;
          const ing = getIngredientsForMeal(mealId);
          ing.forEach(z => {
            text += `  ‚Ä¢ ${z}\n`;
          });
          text += `\n`;
        }
      });

      alert(text);
    }

    function showIngredientsForToday() {
      const today = new Date();
      const todayMonday = getMonday(today);
      const storedMonday = new Date(state.currentMondayISO);

      const sameWeek =
        todayMonday.getFullYear() === storedMonday.getFullYear() &&
        todayMonday.getMonth() === storedMonday.getMonth() &&
        todayMonday.getDate() === storedMonday.getDate();

      if (!sameWeek) {
        alert("Heutiger Tag liegt nicht in der aktuellen gespeicherten Woche.");
        return;
      }

      let dayIndex = today.getDay(); // 0=So
      if (dayIndex === 0) dayIndex = 6; else dayIndex = dayIndex - 1;
      showIngredientsForDay(0, dayIndex);
    }

    function showIngredientsForAllPlanned() {
      let text = "Einkaufsliste ‚Äì alle geplanten Gerichte\n\n";

      function addWeekLabel(weekLabel, weekData) {
        text += weekLabel + "\n\n";
        weekData.forEach((day, dayIndex) => {
          if (!day.lunch && !day.dinner) return;
          text += dayNames[dayIndex] + "\n";
          ["lunch","dinner"].forEach(slotKey => {
            const mealId = day[slotKey];
            const slotLabel = slotKey === "lunch" ? "Mittag" : "Abend";
            if (!mealId) return;
            const meal = getMealById(mealId);
            const name = meal ? meal.name : "(Gericht fehlt)";
            text += `  ${slotLabel} ‚Äì ${name}\n`;
            const ing = getIngredientsForMeal(mealId);
            ing.forEach(z => {
              text += `    ‚Ä¢ ${z}\n`;
            });
          });
          text += "\n";
        });
      }

      addWeekLabel("Aktuelle Woche", state.weekCurrent);
      addWeekLabel("N√§chste Woche", state.weekNext);

      alert(text);
    }

    // Events
    document.getElementById("meal-form").addEventListener("submit", (e) => {
      e.preventDefault();
      const nameInput = document.getElementById("meal-name");
      const emojiInput = document.getElementById("meal-emoji");
      const name = nameInput.value.trim();
      const emoji = (emojiInput.value.trim() || "üçΩÔ∏è");
      if (!name) return;

      const idBase = name.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-|-$/g,"");
      let id = idBase || ("meal-" + Date.now());
      let i = 1;
      while (state.meals.some(m => m.id === id)) {
        id = idBase + "-" + i++;
      }

      state.meals.push({id, name, emoji});
      saveState();
      nameInput.value = "";
      emojiInput.value = "";
      renderAll();
    });

    mealSearchEl.addEventListener("input", () => {
      renderMealList();
    });

    document.getElementById("btn-clear-week").addEventListener("click", () => {
      if (!confirm("Aktuelle Woche wirklich komplett leeren?")) return;
      state.weekCurrent = createEmptyWeek();
      saveState();
      renderWeeks();
    });

    document.getElementById("btn-clear-all").addEventListener("click", () => {
      if (!confirm("Beide Wochen komplett leeren?")) return;
      state.weekCurrent = createEmptyWeek();
      state.weekNext = createEmptyWeek();
      saveState();
      renderWeeks();
    });

    document.getElementById("btn-week-today").addEventListener("click", showIngredientsForToday);
    document.getElementById("btn-shopping-all").addEventListener("click", showIngredientsForAllPlanned);

    function renderAll() {
      renderFavorites();
      renderMealList();
      renderWeeks();
    }

    renderAll();

    if ("serviceWorker" in navigator) {
      window.addEventListener("load", () => {
        navigator.serviceWorker.register("sw.js").catch(err => {
          console.warn("Service Worker Fehler:", err);
        });
      });
    }
  </script>
</body>
</html>
